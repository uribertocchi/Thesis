load("~/GitHub/Thesis/scripts/Hirerchal clustering.RData")
library(EnsDb.Hsapiens.v79)
library(ensembldb)
BiocManager::install('EnsDb.Hsapiens.v79')
library(EnsDb.Hsapiens.v79)
load("~/GitHub/Thesis/scripts/correlate WGBS and RNAseq.RData")
M <- M[order(M$X2, decreasing = FALSE), ]  # Top N highest values by group
View(M)
#plot top 10
top10genes <- M[1:10,1:2]
top10genes$'names' <- rownames(top10genes)
##convert Ensembl to Gene symbols
ensembl.genes <- top10genes$'names'[1:10]
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v79, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
BiocManager::install("EnsDb.Hsapiens.v86")
EnsDb.Hsapiens.v86
install.packages('EnsDb.Hsapiens.v86')
library(ensembldb)
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v86, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
library(ensembldb)
library(EnsDb.Hsapiens.v86)
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v86, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v86, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
library(EnsDb.Hsapiens.v86)
install.packages("C:/Users/admin/Downloads/EnsDb.Hsapiens.v86_2.99.0.tar.gz", repos = NULL, type = "source")
library(EnsDb.Hsapiens.v86)
library(EnsDb.Hsapiens.v86)
library(ggpmisc)
library(ensembldb)
library(tidyverse)
library(ggpubr)
library(jtools)
library(stringr)
library(scales)
library(gridExtra)
library(psych)
library(WGCNA)
library(EnsDb.Hsapiens.v86)
library(ggpmisc)
library(ensembldb)
M <- M[order(M$X2, decreasing = FALSE), ]  # Top N highest values by group
Spearman_correlation_WGBSXRNAseq <- M
write.csv(Spearman_correlation_WGBSXRNAseq, "Spearman_correlation_WGBSXRNAseq.csv")
#plot top 10
top10genes <- M[1:10,1:2]
top10genes$'names' <- rownames(top10genes)
##convert Ensembl to Gene symbols
ensembl.genes <- top10genes$'names'[1:10]
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v86, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
remove.packages(rlang)
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v86, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
geneIDs1$SYMBOL
remove.packages(rlang)
install.packages("rlang")
install.packages("rlang")
library(rlang)
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v86, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v86, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
remove.packages(rlang)
load("~/GitHub/Thesis/scripts/Hirerchal clustering.RData")
load("~/GitHub/Thesis/scripts/Hirerchal clustering.RData")
## make hierarchical clustering heatmap
###RNAseq
counts_rna <- as.matrix(RNAseq_data)
se_rna <- SummarizedExperiment(assays=list(counts=counts_rna))
rld_mat_rna <- assay(se_rna)
rld_cor_rna <- cor(rld_mat_rna,method='spearman')
head(rld_cor_rna)
colnames(RNAseq_data) <- EG
colnames(WGBS_data) <- EG
## make hierarchical clustering heatmap
###RNAseq
counts_rna <- as.matrix(RNAseq_data)
se_rna <- SummarizedExperiment(assays=list(counts=counts_rna))
rld_mat_rna <- assay(se_rna)
rld_cor_rna <- cor(rld_mat_rna,method='spearman')
head(rld_cor_rna)
pheatmap(rld_cor_rna)
library(pheatmap)
install.packages('pheatmap')
library(pheatmap)
library(ggplotify)
remove.packages("rlang", lib="~/R/win-library/4.1")
install.packages('rlang')
library(rlang)
install.packages('rlang')
library(rlang)
install.packages('rlang')
install.packages('rlang')
library(rlang)
install.packages('pheatmap')
install.packages('pheatmap')
library(pheatmap)
library(ggplotify)
head(rld_cor_rna)
pheatmap(rld_cor_rna)
rld_cor_rna <- cor(rld_mat_rna,method='pearson')
head(rld_cor_rna)
pheatmap(rld_cor_rna)
###WGBS
counts_WGBS <- as.matrix(WGBS_data)
se_WGBS <- SummarizedExperiment(assays=list(counts=counts_WGBS))
rld_mat_WGBS <- assay(se_WGBS)
rld_cor_WGBS <- cor(rld_mat_WGBS, use = 'complete.obs', method='pearson')
head(rld_cor_WGBS)
pheatmap(rld_cor_WGBS)
rld_cor_WGBS <- cor(rld_mat_WGBS, use = 'complete.obs', method='spearman')
head(rld_cor_WGBS)
pheatmap(rld_cor_WGBS)
rld_cor_WGBS <- cor(rld_mat_WGBS, use = 'complete.obs', method='pearson')
head(rld_cor_WGBS)
pheatmap(rld_cor_WGBS)
rld_cor_rna <- cor(rld_mat_rna,method='pearson')
head(rld_cor_rna)
pheatmap(rld_cor_rna)
rld_cor_rna <- cor(rld_mat_rna,method='spearman')
head(rld_cor_rna)
pheatmap(rld_cor_rna)
