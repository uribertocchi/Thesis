load("~/GitHub/Thesis/scripts/Hirerchal clustering.RData")
EG_name <- read.csv("~/GitHub/Thesis/EG_name.csv", row.names=1)
View(EG_name)
EG_name <- EG_name[,-1]
EG <- as.data.frame(colnames(WGBS_data))
EG <- left_join(EG, EG_name,by = c("colnames(WGBS_data)" = 'number'))
WGBS_data <- read.csv("C:/Users/Uri Bertocchi/Downloads/WGBS data with methylation avg per 1kb TSS.csv", row.names=1)
View(WGBS_data)
library(readr)
WGBS_data <- read_csv("C:/Users/Uri Bertocchi/Downloads/WGBS data with methylation avg per 1kb TSS.csv")
View(WGBS_data)
library(readr)
RNAseq_data <- read_csv("C:/Users/Uri Bertocchi/Downloads/RNAseq data.csv")
View(RNAseq_data)
EG <- as.data.frame(colnames(WGBS_data))
EG <- left_join(EG, EG_name,by = c("colnames(WGBS_data)" = 'number'))
library(tidyverse)
library(ggpubr)
library(jtools)
library(stringr)
library(scales)
library(gridExtra)
library(psych)
EG <- left_join(EG, EG_name,by = c("colnames(WGBS_data)" = 'number'))
EG <- as.data.frame(colnames(WGBS_data))
EG <- left_join(EG, EG_name,by = c("colnames(WGBS_data)" = 'number'))
WGBS_data <- as.data.frame(WGBS_data)
rownames(WGBS_data) <- RNAseq_data$X1
library(readr)
EG_name <- read_csv("EG_name.csv")
View(EG_name)
EG <- as.data.frame(colnames(WGBS_data))
EG <- left_join(EG, EG_name,by = c("colnames(WGBS_data)" = 'number'))
EG <- EG$'name'
EG_name <- EG_name[,-1]
WGBS_data <- as.data.frame(WGBS_data)
rownames(WGBS_data) <- RNAseq_data$X1
rownames(WGBS_data) <- RNAseq_data$...1
WGBS_data <- WGBS_data[,-1]
colnames(WGBS_data) <- EG
EG <- left_join(EG, EG_name,by = c("colnames(WGBS_data)" = 'number'))
EG <- left_join(EG, EG_name,by = c("name" = 'number'))
library(readr)
EG_name <- read_csv("EG_name.csv")
View(EG_name)
EG <- as.data.frame(colnames(WGBS_data))
EG <- left_join(EG, EG_name,by = c("colnames(WGBS_data)" = 'number'))
EG <- EG$'name'
EG_name <- EG_name[,-1]
WGBS_data <- as.data.frame(WGBS_data)
rownames(WGBS_data) <- RNAseq_data$...1
WGBS_data <- WGBS_data[,-1]
colnames(WGBS_data) <- EG
library(readr)
WGBS_data <- read_csv("C:/Users/Uri Bertocchi/Downloads/WGBS data with methylation avg per 1kb TSS.csv")
View(WGBS_data)
WGBS_data <- as.data.frame(WGBS_data)
rownames(WGBS_data) <- RNAseq_data$...1
WGBS_data <- WGBS_data[,-1]
colnames(WGBS_data) <- EG
RNAseq_data <- as.data.frame(RNAseq_data)
rownames(RNAseq_data) <- RNAseq_data[,1]
RNAseq_data <- RNAseq_data[,-1]
colnames(RNAseq_data) <- EG
cor <- cor(as.data.frame(WGBS_data),as.data.frame(RNAseq_data),method = "spearman", use = 'complete.obs')
#Spearman correlation for WGBS and RNAseq in for each gene
#transpose data
t_WGBS <- t(WGBS_data)
rownames(t_WGBS) <- EG
colnames(t_WGBS) <- rownames(RNAseq_data)
t_RNA <- t(RNAseq_data)
rownames(t_RNA) <- EG
colnames(t_RNA) <- rownames(RNAseq_data)
t_cor <- cor(t_WGBS, t_RNA, method = "spearman", use = "pairwise.complete.obs")
t_cor <- corAndPvalue(t_WGBS, t_RNA, method = "spearman")
t_cor <- corAndPvalue(t_WGBS, t_RNA, method = "spearman")
library(WGCNA)
t_cor <- corAndPvalue(t_WGBS, t_RNA, method = "spearman")
#Spearman correlation
M <- data.frame(matrix(ncol=3,nrow=ncol(t_RNA)))
M[,1] <- as.character()
G <- colnames(t_RNA)
for(i in 1:ncol(t_RNA)){
M[i,1] <- G[i]
cor <- corr.test(as.data.frame(t_RNA[,i]),as.data.frame(t_WGBS[,i]),
method="spearman",adjust="none")
M[i,2] <- cor$r
M[i,3] <- cor$p
}
rownames(M) <- M$X1
M <- M[,-1]
M <- M[order(M$X2, decreasing = TRUE), ]  # Top N highest values by group
Spearman_correlation_WGBSXRNAseq <- M
#plot top 10
top10genes <- M[1:10,1:2]
top10genes$'names' <- rownames(top10genes)
##convert Ensembl to Gene symbols
ensembl.genes <- top10genes$'names'[1:10]
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v79, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v79, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
geneIDs1$SYMBOL
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v79, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
library(EnsDb.Hsapiens.v79)
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v79, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
geneIDs1$SYMBOL
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + stat_cor(method = "spearman", label.x = 3, label.y = 30) + geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
})
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
sp <- sp + stat_cor(method = "spearman", label.x = 3, label.y = 30)
})
grid.arrange(grobs = s, ncol = 2)
install.packages('ggpmisc')
)
library(ggpmisc)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
sp <- sp + geom_smooth(method="lm", se=FALSE) +
stat_fit_glance(method = 'lm', geom = 'text', aes(label = paste0('p = ', round(..p.value.., 3))), label.x.npc = 0.4, label.y.npc = 1)
})
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
sp <- sp + geom_smooth(method="lm", se=FALSE) +
stat_fit_glance(method = 'lm', geom = 'text', aes(label = paste0('p = ', round(..p.value.., 3))))
})
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
sp <- sp + geom_smooth(method="lm", se=FALSE) })
grid.arrange(grobs = s, ncol = 2)
grid.arrange(grobs = sp, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
sp <- s + geom_smooth(method="lm", se=FALSE) })
grid.arrange(grobs = sp, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
sp <- s + geom_smooth(method="lm", se=FALSE) })
grid.arrange(grobs = sp, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
sp <- sp + geom_smooth(method="lm", se=FALSE) })
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_smooth(method="lm", se=FALSE)+geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
})
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_smooth(method="lm", se=FALSE)+geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL))
})
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_smooth(method="lm", se=FALSE)+geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL)
})
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggscatter(df, x = as.factor(df$x), y = as.numeric(df$y),
add = "reg.line",  # Add regressin line
add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
conf.int = TRUE # Add confidence interval
)
# Add correlation coefficient
sp + stat_cor(method = "pearson", label.x = 3, label.y = 30)
})
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggplot(data = df, aes(x = as.factor(df$x), y = as.numeric(df$y))) + geom_point() + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
})
df <- data.frame(x=t_WGBS[,1],y= t_RNA[,1])
View(df)
View(df)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggscatter(df, x = as.factor(df$x), y = 'y',
add = "reg.line",  # Add regressin line
add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
conf.int = TRUE # Add confidence interval
)
# Add correlation coefficient
sp + stat_cor(method = "pearson", label.x = 3, label.y = 30)
})
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggscatter(df, x = 'x', y = 'y',
add = "reg.line",  # Add regressin line
add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
conf.int = TRUE # Add confidence interval
)
# Add correlation coefficient
sp + stat_cor(method = "pearson", label.x = 3, label.y = 30)
})
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggscatter(df, x = 'x', y = 'y',
add = "reg.line",  # Add regressin line
add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
conf.int = TRUE # Add confidence interval
)
# Add correlation coefficient
sp + stat_cor(method = "spreaman")
})
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggscatter(df, x = 'x', y = 'y',
add = "reg.line",  # Add regressin line
add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
conf.int = TRUE # Add confidence interval
) + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM (log2)", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# Add correlation coefficient
sp + stat_cor(method = "spreaman")
})
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggscatter(df, x = 'x', y = 'y',
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE # Add confidence interval
) + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# Add correlation coefficient
sp + stat_cor(method = "spreaman")
})
grid.arrange(grobs = s, ncol = 2)
warnings()
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggscatter(df, x = 'x', y = 'y',
add = "reg.line",  # Add regressin line
add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
conf.int = TRUE # Add confidence interval
) + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# Add correlation coefficient
sp + stat_cor(method = "spearman")
})
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggscatter(df, x = 'x', y = 'y',
add = "reg.line",  # Add regressin line
add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
conf.int = TRUE # Add confidence interval
) + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# Add correlation coefficient
sp + stat_cor(method = "pearson")
})
grid.arrange(grobs = s, ncol = 2)
save.image("~/GitHub/Thesis/scripts/correlate WGBS and RNAseq.RData")
M <- M[order(M$X2, decreasing = FALSE), ]  # Top N highest values by group
Spearman_correlation_WGBSXRNAseq <- M
#plot top 10
top10genes <- M[1:10,1:2]
top10genes$'names' <- rownames(top10genes)
##convert Ensembl to Gene symbols
ensembl.genes <- top10genes$'names'[1:10]
geneIDs1 <- ensembldb::select(EnsDb.Hsapiens.v79, keys= ensembl.genes, keytype = "GENEID", columns = c("SYMBOL","GENEID"))
geneIDs1$SYMBOL
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggscatter(df, x = 'x', y = 'y',
add = "reg.line",  # Add regressin line
add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
conf.int = TRUE # Add confidence interval
) + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# Add correlation coefficient
sp + stat_cor(method = "pearson")
})
grid.arrange(grobs = s, ncol = 2)
s <- lapply(1:10, function(i){
gene <- top10genes$'names'[i]
gene_SYMBOL <- geneIDs1$SYMBOL[i]
df <- data.frame(x=t_WGBS[,gene],y= t_RNA[,gene])
sp <- ggscatter(df, x = 'x', y = 'y',
add = "reg.line",  # Add regressin line
add.params = list(color = "blue", fill = "lightgray"), # Customize reg. line
conf.int = TRUE # Add confidence interval
) + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
# Add correlation coefficient
sp + stat_cor(method = "spearman")
})
grid.arrange(grobs = s, ncol = 2)
density(cor)
#Density plots
cor
cor <- cor(as.data.frame(WGBS_data),as.data.frame(RNAseq_data),method = "spearman", use = 'complete.obs')
#Density plots
cor
View(cor)
#Density plots
Spearman_correlation_WGBSXRNAseq
#Density plots
Spearman_correlation_WGBSXRNAseq$X2
#Density plots
density(Spearman_correlation_WGBSXRNAseq$X2)
#Density plots
plot(density(Spearman_correlation_WGBSXRNAseq$X2))
#Density plots
plot(density(na.omit(Spearman_correlation_WGBSXRNAseq$X2))
#Density plots
plot(density(na.omit(Spearman_correlation_WGBSXRNAseq$X2)))
#Density plots
plot(density(na.omit(Spearman_correlation_WGBSXRNAseq$X2)))
#Spearman correlation
spearman <- data.frame(matrix(ncol=3,nrow=ncol(t_RNA)))
spearman[,1] <- as.character()
G <- colnames(t_RNA)
for(i in 1:ncol(t_RNA)){
spearman[i,1] <- G[i]
cor <- corr.test(as.data.frame(t_RNA[,i]),as.data.frame(t_WGBS[,i]),
method="spearman",adjust="none")
spearman[i,2] <- cor$r
spearman[i,3] <- cor$p
}
rownames(spearman) <- spearman$X1
spearman <- spearman[,-1]
spearman <- spearman[order(spearman$X2, decreasing = FALSE), ]  # Top N highest values by group
Spearman_correlation_WGBSXRNAseq <- spearman
#Spearman correlation
pearson <- data.frame(matrix(ncol=3,nrow=ncol(t_RNA)))
pearson[,1] <- as.character()
G <- colnames(t_RNA)
for(i in 1:ncol(t_RNA)){
pearson[i,1] <- G[i]
cor <- corr.test(as.data.frame(t_RNA[,i]),as.data.frame(t_WGBS[,i]),
method="pearson",adjust="none")
pearson[i,2] <- cor$r
pearson[i,3] <- cor$p
}
rownames(pearson) <- pearson$X1
pearson <- pearson[,-1]
pearson <- pearson[order(pearson$X2, decreasing = FALSE), ]  # Top N highest values by group
pearson_correlation_WGBSXRNAseq <- pearson
write.csv(pearson_correlation_WGBSXRNAseq, "pearson_correlation_WGBSXRNAseq.csv")
#Density plots
spearman_densityplot <- plot(density(na.omit(Spearman_correlation_WGBSXRNAseq$X2)))
#Density plots
pearson_densityplot <- plot(density(na.omit(pearson_correlation_WGBSXRNAseq$X2)))
pearson_densityplot <- plot(density(na.omit(pearson_correlation_WGBSXRNAseq$X2)))
#Density plots
Spearman_densityplot <- plot(density(na.omit(Spearman_correlation_WGBSXRNAseq$X2)))
pearson_densityplot <- plot(density(na.omit(pearson_correlation_WGBSXRNAseq$X2)))
#Density plots
Spearman_densityplot <- ggdensity(na.omit(Spearman_correlation_WGBSXRNAseq$X2)))
#Density plots
Spearman_densityplot <- ggdensity(na.omit(Spearman_correlation_WGBSXRNAseq$X2))
Spearman_densityplot
#Density plots
Spearman_densityplot <- ggdensity(na.omit(Spearman_correlation_WGBSXRNAseq$X2)) + labs(x = "DNA Methylation (%)", y = "Gene Exp. RPKM", title = gene_SYMBOL) + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
#Density plots
Spearman_densityplot <- ggdensity(na.omit(Spearman_correlation_WGBSXRNAseq$X2)) + labs(x = "Correlation r", y = "Density", title = 'Density of WGBS*RNAseq spearman correlation') + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
Spearman_densityplot
pearson_densityplot <- ggdensity(na.omit(pearson_correlation_WGBSXRNAseq$X2)) + labs(x = "Correlation r", y = "Density", title = 'Density of WGBS*RNAseq pearson correlation') + theme_bw() + theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pearson_densityplot
#Density plots
Spearman_densityplot <- ggdensity(na.omit(Spearman_correlation_WGBSXRNAseq$X2)) + labs(x = "Correlation r", y = "Density", title = 'Density of WGBS*RNAseq spearman correlation') + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pearson_densityplot <- ggdensity(na.omit(pearson_correlation_WGBSXRNAseq$X2)) + labs(x = "Correlation r", y = "Density", title = 'Density of WGBS*RNAseq pearson correlation') + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pearson_densityplot
#Density plots
Spearman_densityplot <- ggdensity(na.omit(Spearman_correlation_WGBSXRNAseq$X2)) + labs(x = "Correlation r", y = "Density", title = 'Density of WGBS*RNAseq spearman correlation') + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pearson_densityplot <- ggdensity(na.omit(pearson_correlation_WGBSXRNAseq$X2)) + labs(x = "Correlation r", y = "Density", title = 'Density of WGBS*RNAseq pearson correlation') + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pearson_densityplot
Spearman_densityplot
#Density plots
Spearman_densityplot <- ggdensity(na.omit(Spearman_correlation_WGBSXRNAseq$X2)) + labs(x = "Correlation r", y = "Density", title = 'Density of methylation*expression (spearman)') + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
pearson_densityplot <- ggdensity(na.omit(pearson_correlation_WGBSXRNAseq$X2)) + labs(x = "Correlation r", y = "Density", title = 'Density of methylation*expression (pearson)') + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
Spearman_densityplot
pearson_densityplot
